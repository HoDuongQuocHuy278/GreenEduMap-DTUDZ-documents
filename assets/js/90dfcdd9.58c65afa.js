"use strict";(self.webpackChunkgreenedumap_docs=self.webpackChunkgreenedumap_docs||[]).push([[970],{7731:(e,n,r)=>{r.r(n),r.d(n,{assets:()=>c,contentTitle:()=>l,default:()=>h,frontMatter:()=>t,metadata:()=>a,toc:()=>d});var i=r(4848),s=r(8453);const t={},l="\ud83c\udf10 API Gateway Service",a={id:"Services/APIGatewayService/Readme",title:"\ud83c\udf10 API Gateway Service",description:"\ud83d\udccb T\u1ed5ng quan",source:"@site/docs/Services/APIGatewayService/Readme.md",sourceDirName:"Services/APIGatewayService",slug:"/Services/APIGatewayService/",permalink:"/GreenEduMap-DTUDZ-documents/Services/APIGatewayService/",draft:!1,unlisted:!1,editUrl:"https://github.com/HoDuongQuocHuy278/GreenEduMap-DTUDZ-documents/edit/main/docs/Services/APIGatewayService/Readme.md",tags:[],version:"current",frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"\ud83d\udcda GreenEduMap Services Documentation",permalink:"/GreenEduMap-DTUDZ-documents/Services/"},next:{title:"\ud83d\udd10 Auth Service",permalink:"/GreenEduMap-DTUDZ-documents/Services/AuthService/"}},c={},d=[{value:"\ud83d\udccb T\u1ed5ng quan",id:"-t\u1ed5ng-quan",level:2},{value:"\ud83c\udfaf Ch\u1ee9c n\u0103ng ch\xednh",id:"-ch\u1ee9c-n\u0103ng-ch\xednh",level:2},{value:"\ud83d\udd00 Service Routing &amp; Orchestration",id:"-service-routing--orchestration",level:3},{value:"\ud83c\udf0d Public OpenData API",id:"-public-opendata-api",level:3},{value:"Environment Data Endpoints",id:"environment-data-endpoints",level:4},{value:"Education Data Endpoints",id:"education-data-endpoints",level:4},{value:"Export Endpoints",id:"export-endpoints",level:4},{value:"\ud83d\udd17 NGSI-LD Endpoints",id:"-ngsi-ld-endpoints",level:3},{value:"\ud83d\udee1\ufe0f Security &amp; Rate Limiting",id:"\ufe0f-security--rate-limiting",level:3},{value:"\ud83d\udcca Monitoring &amp; Logging",id:"-monitoring--logging",level:3},{value:"\ud83c\udfd7\ufe0f Ki\u1ebfn tr\xfac",id:"\ufe0f-ki\u1ebfn-tr\xfac",level:2},{value:"\ud83d\udd0c Service Routing Configuration",id:"-service-routing-configuration",level:2},{value:"Microservices Endpoints",id:"microservices-endpoints",level:3},{value:"\ud83d\ude80 Setup &amp; Configuration",id:"-setup--configuration",level:2},{value:"Environment Variables",id:"environment-variables",level:3},{value:"Docker Deployment",id:"docker-deployment",level:3},{value:"Local Development",id:"local-development",level:3},{value:"\ud83d\udce1 API Examples",id:"-api-examples",level:2},{value:"Get Air Quality Data",id:"get-air-quality-data",level:3},{value:"Get Schools by Green Score",id:"get-schools-by-green-score",level:3},{value:"Export Schools to GeoJSON",id:"export-schools-to-geojson",level:3},{value:"\ud83d\udd0d Health Check",id:"-health-check",level:2},{value:"Gateway Health",id:"gateway-health",level:3},{value:"\ud83d\udcca Monitoring &amp; Metrics",id:"-monitoring--metrics",level:2},{value:"Prometheus Metrics",id:"prometheus-metrics",level:3},{value:"Grafana Dashboard",id:"grafana-dashboard",level:3},{value:"\ud83d\udee0\ufe0f Development",id:"\ufe0f-development",level:2},{value:"Adding New Route",id:"adding-new-route",level:3},{value:"Adding Service Integration",id:"adding-service-integration",level:3},{value:"\ud83d\udcc4 License",id:"-license",level:2}];function o(e){const n={a:"a",blockquote:"blockquote",br:"br",code:"code",h1:"h1",h2:"h2",h3:"h3",h4:"h4",hr:"hr",li:"li",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,s.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.h1,{id:"-api-gateway-service",children:"\ud83c\udf10 API Gateway Service"}),"\n",(0,i.jsx)(n.h2,{id:"-t\u1ed5ng-quan",children:"\ud83d\udccb T\u1ed5ng quan"}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Ng\xf4n ng\u1eef l\u1eadp tr\xecnh:"})," Python 3.11 + FastAPI",(0,i.jsx)(n.br,{}),"\n",(0,i.jsx)(n.strong,{children:"Port:"})," 8000",(0,i.jsx)(n.br,{}),"\n",(0,i.jsx)(n.strong,{children:"Tr\u1ea1ng th\xe1i:"})," \u2705 Ho\u1ea1t \u0111\u1ed9ng"]}),"\n",(0,i.jsxs)(n.p,{children:["API Gateway l\xe0 c\u1ed5ng trung t\xe2m cho ki\u1ebfn tr\xfac microservices c\u1ee7a ",(0,i.jsx)(n.strong,{children:"GreenEduMap"}),", cung c\u1ea5p \u0111i\u1ec3m truy c\u1eadp duy nh\u1ea5t cho t\u1ea5t c\u1ea3 c\xe1c d\u1ecbch v\u1ee5 backend, x\u1eed l\xfd \u0111\u1ecbnh tuy\u1ebfn, x\xe1c th\u1ef1c v\xe0 qu\u1ea3n l\xfd API c\xf4ng khai."]}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"-ch\u1ee9c-n\u0103ng-ch\xednh",children:"\ud83c\udfaf Ch\u1ee9c n\u0103ng ch\xednh"}),"\n",(0,i.jsx)(n.h3,{id:"-service-routing--orchestration",children:"\ud83d\udd00 Service Routing & Orchestration"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"\u0110\u1ecbnh tuy\u1ebfn th\xf4ng minh"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Chuy\u1ec3n ti\u1ebfp request \u0111\u1ebfn microservice ph\xf9 h\u1ee3p"}),"\n",(0,i.jsx)(n.li,{children:"Load balancing gi\u1eefa c\xe1c service instances"}),"\n",(0,i.jsx)(n.li,{children:"Circuit breaker pattern"}),"\n",(0,i.jsx)(n.li,{children:"Retry logic v\u1edbi exponential backoff"}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Service Discovery"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"T\u1ef1 \u0111\u1ed9ng ph\xe1t hi\u1ec7n services"}),"\n",(0,i.jsx)(n.li,{children:"Health check aggregation"}),"\n",(0,i.jsx)(n.li,{children:"Dynamic routing configuration"}),"\n",(0,i.jsx)(n.li,{children:"Failover handling"}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Request/Response Transformation"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Header manipulation"}),"\n",(0,i.jsx)(n.li,{children:"Request validation"}),"\n",(0,i.jsx)(n.li,{children:"Response formatting"}),"\n",(0,i.jsx)(n.li,{children:"Error standardization"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"-public-opendata-api",children:"\ud83c\udf0d Public OpenData API"}),"\n",(0,i.jsxs)(n.blockquote,{children:["\n",(0,i.jsxs)(n.p,{children:["[!NOTE]\r\n",(0,i.jsx)(n.strong,{children:"Kh\xf4ng y\xeau c\u1ea7u x\xe1c th\u1ef1c"})," - API c\xf4ng khai tu\xe2n th\u1ee7 chu\u1ea9n Open Data"]}),"\n"]}),"\n",(0,i.jsx)(n.h4,{id:"environment-data-endpoints",children:"Environment Data Endpoints"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"# Air Quality Data\r\nGET /api/open-data/air-quality\r\nGET /api/open-data/air-quality/location?lat={lat}&lon={lon}&radius={km}\r\n\r\n# Weather Data\r\nGET /api/open-data/weather/current?lat={lat}&lon={lon}\r\nGET /api/open-data/weather/forecast?lat={lat}&lon={lon}\n"})}),"\n",(0,i.jsx)(n.h4,{id:"education-data-endpoints",children:"Education Data Endpoints"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"# Schools Information\r\nGET /api/open-data/schools\r\nGET /api/open-data/schools/location?lat={lat}&lon={lon}&radius={km}\r\nGET /api/open-data/schools/green-score\r\n\r\n# Green Courses\r\nGET /api/open-data/green-courses\r\nGET /api/open-data/green-courses/by-school/{school_id}\n"})}),"\n",(0,i.jsx)(n.h4,{id:"export-endpoints",children:"Export Endpoints"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"# Export to various formats\r\nGET /api/open-data/export/air-quality?format=csv\r\nGET /api/open-data/export/schools?format=geojson\r\nGET /api/open-data/export/green-courses?format=json\n"})}),"\n",(0,i.jsx)(n.h3,{id:"-ngsi-ld-endpoints",children:"\ud83d\udd17 NGSI-LD Endpoints"}),"\n",(0,i.jsxs)(n.p,{children:["H\u1ed7 tr\u1ee3 chu\u1ea9n ",(0,i.jsx)(n.strong,{children:"NGSI-LD"})," (ETSI GS CIM 009) cho Smart Cities:"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"# Entity Management\r\nGET    /ngsi-ld/v1/entities\r\nGET    /ngsi-ld/v1/entities?type=AirQuality\r\nGET    /ngsi-ld/v1/entities?type=School\r\nGET    /ngsi-ld/v1/entities/{id}\r\nPOST   /ngsi-ld/v1/entities\r\nPATCH  /ngsi-ld/v1/entities/{id}\r\nDELETE /ngsi-ld/v1/entities/{id}\r\n\r\n# Subscriptions\r\nPOST   /ngsi-ld/v1/subscriptions\r\nGET    /ngsi-ld/v1/subscriptions\r\nDELETE /ngsi-ld/v1/subscriptions/{id}\n"})}),"\n",(0,i.jsx)(n.h3,{id:"\ufe0f-security--rate-limiting",children:"\ud83d\udee1\ufe0f Security & Rate Limiting"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Rate Limiting"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Per-IP rate limits"}),"\n",(0,i.jsx)(n.li,{children:"Per-API-key quotas"}),"\n",(0,i.jsx)(n.li,{children:"Sliding window algorithm"}),"\n",(0,i.jsx)(n.li,{children:"Redis-backed counters"}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"CORS Handling"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Configurable origins"}),"\n",(0,i.jsx)(n.li,{children:"Preflight request handling"}),"\n",(0,i.jsx)(n.li,{children:"Credential support"}),"\n",(0,i.jsx)(n.li,{children:"Custom headers"}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Authentication (for protected endpoints)"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"JWT token validation"}),"\n",(0,i.jsx)(n.li,{children:"API key authentication"}),"\n",(0,i.jsx)(n.li,{children:"Role-based access control (RBAC)"}),"\n",(0,i.jsx)(n.li,{children:"OAuth2 integration ready"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"-monitoring--logging",children:"\ud83d\udcca Monitoring & Logging"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Health Check Aggregation"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Individual service health status"}),"\n",(0,i.jsx)(n.li,{children:"Overall system health"}),"\n",(0,i.jsx)(n.li,{children:"Dependency checks"}),"\n",(0,i.jsx)(n.li,{children:"Readiness probes"}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Metrics Collection"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Request/response times"}),"\n",(0,i.jsx)(n.li,{children:"Error rates"}),"\n",(0,i.jsx)(n.li,{children:"Throughput metrics"}),"\n",(0,i.jsx)(n.li,{children:"Service availability"}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Distributed Tracing"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Request correlation IDs"}),"\n",(0,i.jsx)(n.li,{children:"End-to-end tracing"}),"\n",(0,i.jsx)(n.li,{children:"Performance bottleneck detection"}),"\n",(0,i.jsx)(n.li,{children:"Jaeger integration"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"\ufe0f-ki\u1ebfn-tr\xfac",children:"\ud83c\udfd7\ufe0f Ki\u1ebfn tr\xfac"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\r\n\u2502                   Client Layer                      \u2502\r\n\u2502  (Web App, Mobile App, External Services)          \u2502\r\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\r\n                       \u2502\r\n                       \u2193\r\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\r\n\u2502              API Gateway (Port 8000)                \u2502\r\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\r\n\u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 \u2502\r\n\u2502  \u2502 Rate Limiter \u2502  \u2502 CORS Handler \u2502  \u2502  Router   \u2502 \u2502\r\n\u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518 \u2502\r\n\u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 \u2502\r\n\u2502  \u2502 Auth Checker \u2502  \u2502   Logger     \u2502  \u2502  Metrics  \u2502 \u2502\r\n\u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518 \u2502\r\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\r\n                       \u2502\r\n         \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\r\n         \u2502             \u2502             \u2502\r\n         \u2193             \u2193             \u2193\r\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\r\n\u2502   Auth     \u2502  \u2502Environment \u2502  \u2502 Education  \u2502\r\n\u2502  Service   \u2502  \u2502  Service   \u2502  \u2502  Service   \u2502\r\n\u2502 (Port 8001)\u2502  \u2502(Port 8007) \u2502  \u2502(Port 8008) \u2502\r\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\r\n         \u2502             \u2502             \u2502\r\n         \u2193             \u2193             \u2193\r\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\r\n\u2502 Resource   \u2502  \u2502  OpenData  \u2502  \u2502    AI      \u2502\r\n\u2502  Service   \u2502  \u2502  Service   \u2502  \u2502  Service   \u2502\r\n\u2502(Port 8004) \u2502  \u2502(Port 8009) \u2502  \u2502(Port 8006) \u2502\r\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n"})}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"-service-routing-configuration",children:"\ud83d\udd0c Service Routing Configuration"}),"\n",(0,i.jsx)(n.h3,{id:"microservices-endpoints",children:"Microservices Endpoints"}),"\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"Service"}),(0,i.jsx)(n.th,{children:"Port"}),(0,i.jsx)(n.th,{children:"Base Path"}),(0,i.jsx)(n.th,{children:"Description"})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.strong,{children:"Auth Service"})}),(0,i.jsx)(n.td,{children:"8001"}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"/api/v1/auth"})}),(0,i.jsx)(n.td,{children:"Authentication & Authorization"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.strong,{children:"Environment Service"})}),(0,i.jsx)(n.td,{children:"8007"}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"/api/v1/environment"})}),(0,i.jsx)(n.td,{children:"Air quality & Weather data"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.strong,{children:"Education Service"})}),(0,i.jsx)(n.td,{children:"8008"}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"/api/v1/education"})}),(0,i.jsx)(n.td,{children:"Schools & Green courses"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.strong,{children:"Resource Service"})}),(0,i.jsx)(n.td,{children:"8004"}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"/api/v1/resources"})}),(0,i.jsx)(n.td,{children:"Green zones & Resources"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.strong,{children:"AI Service"})}),(0,i.jsx)(n.td,{children:"8006"}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"/api/v1/ai"})}),(0,i.jsx)(n.td,{children:"ML predictions & Analytics"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.strong,{children:"OpenData Service"})}),(0,i.jsx)(n.td,{children:"8009"}),(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"/api/v1/opendata"})}),(0,i.jsx)(n.td,{children:"NGSI-LD & Export formats"})]})]})]}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"-setup--configuration",children:"\ud83d\ude80 Setup & Configuration"}),"\n",(0,i.jsx)(n.h3,{id:"environment-variables",children:"Environment Variables"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-env",children:"# API Gateway Configuration\r\nGATEWAY_HOST=0.0.0.0\r\nGATEWAY_PORT=8000\r\nVERSION=1.0.0\r\n\r\n# Service URLs\r\nAUTH_SERVICE_URL=http://auth-service:8001\r\nENVIRONMENT_SERVICE_URL=http://environment-service:8007\r\nEDUCATION_SERVICE_URL=http://education-service:8008\r\nRESOURCE_SERVICE_URL=http://resource-service:8004\r\nAI_SERVICE_URL=http://ai-service:8006\r\nOPENDATA_SERVICE_URL=http://opendata-service:8009\r\n\r\n# Rate Limiting\r\nRATE_LIMIT_ENABLED=true\r\nRATE_LIMIT_PER_MINUTE=60\r\nRATE_LIMIT_PER_HOUR=1000\r\n\r\n# CORS\r\nCORS_ORIGINS=http://localhost:3000,https://greenedumap.edu.vn\r\nCORS_ALLOW_CREDENTIALS=true\r\n\r\n# Redis (for rate limiting & caching)\r\nREDIS_HOST=redis\r\nREDIS_PORT=6379\r\n\r\n# RabbitMQ (for async tasks)\r\nRABBITMQ_URL=amqp://admin:admin123@rabbitmq:5672/greenedumap\n"})}),"\n",(0,i.jsx)(n.h3,{id:"docker-deployment",children:"Docker Deployment"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-yaml",children:'api-gateway:\r\n  build: ./modules/api-gateway\r\n  ports:\r\n    - "8000:8000"\r\n  depends_on:\r\n    - redis\r\n    - rabbitmq\r\n    - auth-service\r\n    - environment-service\r\n    - education-service\r\n  environment:\r\n    - GATEWAY_PORT=8000\r\n    - REDIS_HOST=redis\r\n    - RABBITMQ_URL=amqp://admin:admin123@rabbitmq:5672/greenedumap\r\n  networks:\r\n    - greenedumap-network\n'})}),"\n",(0,i.jsx)(n.h3,{id:"local-development",children:"Local Development"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"# Install dependencies\r\ncd modules/api-gateway\r\npip install -r requirements.txt\r\n\r\n# Run gateway\r\nuvicorn app.main:app --reload --port 8000\r\n\r\n# Access documentation\r\nopen http://localhost:8000/docs\n"})}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"-api-examples",children:"\ud83d\udce1 API Examples"}),"\n",(0,i.jsx)(n.h3,{id:"get-air-quality-data",children:"Get Air Quality Data"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:'curl "http://localhost:8000/api/open-data/air-quality/location?lat=16.0544&lon=108.2022&radius=50"\n'})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Response:"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-json",children:'{\r\n  "data": [\r\n    {\r\n      "id": "uuid-123",\r\n      "location": "Da Nang",\r\n      "aqi": 45,\r\n      "pm25": 12.5,\r\n      "pm10": 25.3,\r\n      "timestamp": "2025-12-04T22:00:00Z"\r\n    }\r\n  ],\r\n  "count": 1\r\n}\n'})}),"\n",(0,i.jsx)(n.h3,{id:"get-schools-by-green-score",children:"Get Schools by Green Score"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:'curl "http://localhost:8000/api/open-data/schools/green-score?min_score=80"\n'})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Response:"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-json",children:'{\r\n  "data": [\r\n    {\r\n      "id": "uuid-456",\r\n      "name": "Tr\u01b0\u1eddng THPT Chuy\xean L\xea Qu\xfd \u0110\xf4n",\r\n      "green_score": 92,\r\n      "location": {\r\n        "lat": 16.0544,\r\n        "lon": 108.2022\r\n      }\r\n    }\r\n  ],\r\n  "count": 1\r\n}\n'})}),"\n",(0,i.jsx)(n.h3,{id:"export-schools-to-geojson",children:"Export Schools to GeoJSON"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:'curl "http://localhost:8000/api/open-data/export/schools?format=geojson" -o schools.geojson\n'})}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"-health-check",children:"\ud83d\udd0d Health Check"}),"\n",(0,i.jsx)(n.h3,{id:"gateway-health",children:"Gateway Health"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"GET /health\n"})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Response:"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-json",children:'{\r\n  "status": "healthy",\r\n  "service": "api-gateway",\r\n  "version": "1.0.0",\r\n  "services": {\r\n    "auth-service": "healthy",\r\n    "environment-service": "healthy",\r\n    "education-service": "healthy",\r\n    "resource-service": "healthy",\r\n    "ai-service": "healthy",\r\n    "opendata-service": "healthy"\r\n  },\r\n  "dependencies": {\r\n    "redis": "connected",\r\n    "rabbitmq": "connected"\r\n  }\r\n}\n'})}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"-monitoring--metrics",children:"\ud83d\udcca Monitoring & Metrics"}),"\n",(0,i.jsx)(n.h3,{id:"prometheus-metrics",children:"Prometheus Metrics"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:"GET /metrics\n"})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Available Metrics:"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"http_requests_total"})," - Total HTTP requests"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"http_request_duration_seconds"})," - Request duration histogram"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"http_requests_in_progress"})," - Current requests in progress"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"service_health_status"})," - Health status of downstream services"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"rate_limit_exceeded_total"})," - Rate limit violations"]}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"grafana-dashboard",children:"Grafana Dashboard"}),"\n",(0,i.jsxs)(n.p,{children:["Pre-configured dashboard available at: ",(0,i.jsx)(n.code,{children:"infrastructure/monitoring/grafana/dashboards/api-gateway.json"})]}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"\ufe0f-development",children:"\ud83d\udee0\ufe0f Development"}),"\n",(0,i.jsx)(n.h3,{id:"adding-new-route",children:"Adding New Route"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:'from fastapi import APIRouter\r\n\r\nrouter = APIRouter(prefix="/api/v1/new-feature", tags=["New Feature"])\r\n\r\n@router.get("/")\r\nasync def get_new_feature():\r\n    return {"message": "New feature endpoint"}\n'})}),"\n",(0,i.jsx)(n.h3,{id:"adding-service-integration",children:"Adding Service Integration"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:'from app.core.config import settings\r\nimport httpx\r\n\r\nasync def call_new_service(endpoint: str):\r\n    async with httpx.AsyncClient() as client:\r\n        response = await client.get(\r\n            f"{settings.NEW_SERVICE_URL}{endpoint}"\r\n        )\r\n        return response.json()\n'})}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"-license",children:"\ud83d\udcc4 License"}),"\n",(0,i.jsxs)(n.p,{children:["D\u1ef1 \xe1n n\xe0y \u0111\u01b0\u1ee3c ph\xe2n ph\u1ed1i d\u01b0\u1edbi ",(0,i.jsx)(n.a,{href:"https://github.com/HoDuongQuocHuy278/GreenEduMap-DTUDZ/blob/main/LICENSE",children:"GNU General Public License v3.0"}),"."]})]})}function h(e={}){const{wrapper:n}={...(0,s.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(o,{...e})}):o(e)}},8453:(e,n,r)=>{r.d(n,{R:()=>l,x:()=>a});var i=r(6540);const s={},t=i.createContext(s);function l(e){const n=i.useContext(t);return i.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:l(e.components),i.createElement(t.Provider,{value:n},e.children)}}}]);